"use strict";function getChainData(e){for(var t=function(e){var t=e.sides.getAttribute("data-tool-url")||"",n=function(e){var t=JSON.parse(e.sides.getAttribute("data-override-options")||"{}"),n=[],o=e.options.get(),i=Object.keys(o);if(i.length)for(var r=0;r<i.length;r++){var a=i[r];if(void 0===t[a]){var s=o[a];n.push(encodeURIComponent(a)+"="+encodeURIComponent(s))}}return n}(e);return 0==n.length?t:t+encodeURIComponent("?"+n.join("&"))},n=[],o=e;o.chainChild;)o=o.chainChild,n.push(t(o));return n}function chainPrimaryTool(){var e=getURLQuery("chain");e&&chainToolWithArray(primaryTool,e.split(","),function(e){})}function removeChainedTools(e){for(var t=document.querySelector(".all-tools-container"),n=e.sides.querySelector(".side.output .side-widgets .widget-chain"),o=t.querySelector(".tool-chained:last-child");o&&o.tool!=e;)o.tool.chainParent.removeChain(),o.tool.destroy(),o=t.querySelector(".tool-chained:last-child");n.classList.remove("is-disabled"),n.textContent="Chain with...",e.sides.classList.remove("is-chained"),zenscroll.intoView(e.sides,400)}function chainToolWithArray(e,t,n){for(var o=document.querySelectorAll(".all-tools-container .tool"),i=e,r=0,a=0;r<t.length;r++,a++){var s=t[r].split(encodeURIComponent("?")),l=s[0],u={},c=s[1];if(c){c=decodeURIComponent(c).split("&");for(var d=0;d<c.length;d++){var p=c[d].split("="),v=decodeURIComponent(p[0]),g=decodeURIComponent(p[1]||"");"true"!=g&&"yes"!=g&&"false"!=g&&"no"!=g||(g="true"==g||"yes"==g),v&&(u[v]=g)}}var h=o[a+1];if(!h){i.output.showNegativeBadge('No tool with URL "{0}" was found'.format(l),"Last URL in your query might be invalid."),zenscroll.intoView(i.sides,400);break}if(l==h.getAttribute("data-tool-url")){var f=h.getAttribute("data-tool-bridge")||h.getAttribute("data-tool-url"),m=createTool(f,{sides:h,examples:null,chained:!0});if(!m){i.output.showNegativeBadge('Can\'t chain with "{0}"'.format(l),'Bridge "{0}" is not available.'.format(f)),zenscroll.intoView(i.sides,400);break}c&&m.options.set(u),i.attachChain(m),i.output.showStatus("chained!"),i.sides.classList.add("is-chained"),zenscroll.intoView(m.sides,400),makeAutosizeTextareas(),makeColorpickers(),i=m}else{if(t[r+1])var y='"'+t[r+1].split(encodeURIComponent("?"))[0]+'"';else y="next tool";i.output.showNegativeBadge('No tool with URL "{0}" was found'.format(l),"Chaining with {0} instead.".format(y)),a--}}n(i)}function chainToolWith(i,e,r){var a=i.sides,s=i.output,l=i.sides.querySelector(".side.output .side-widgets .widget-chain"),u=document.querySelector(".all-tools-container");l.classList.remove("is-disabled"),a.classList.remove("is-chained"),l.classList.add("is-disabled"),l.textContent="Chaining...",s.showStatus("chaining..."),s.hideBadge(),Site.GET("chain.json?tool="+e,function(e){var t=e.responseText;if(4==e.readyState&&200==e.status)try{var o=JSON.parse(t);s.showStatus("loading libraries...");var n={js:o.js,css:o.css};Site.resources.importFrom(n,function(){var e=document.createElement("div");e.innerHTML=o.html;var t=e.firstChild;u.insertBefore(t,i.sides.nextSibling);var n=createTool(o.call,{sides:t,examples:null,chained:!0});i.attachChain(n),s.showStatus("chained!"),l.textContent="Chained!",a.classList.add("is-chained"),s.hideBadge(),zenscroll.intoView(n.sides,400),makeAutosizeTextareas(),makeColorpickers(),"function"==typeof r&&r(n)})}catch(e){console.log(e),s.showNegativeBadge("Server error","Something has gone wrong while chaining the tool.",-1),l.classList.remove("is-disabled"),l.textContent="Retry chain?"}else 4==e.readyState&&(s.showNegativeBadge("Server error","We can't chain this tool due to a server error.",-1),l.classList.remove("is-disabled"),l.textContent="Retry chain?")})}function makePrimaryTool(){var e=document.querySelector(".all-tools-container .tool-primary"),t=e.getAttribute("data-tool-bridge")||e.getAttribute("data-tool-url");primaryTool=createTool(t,{sides:e,examples:document.querySelector(".examples-primary"),chained:!1})}function createTool(e,t){var n=void 0!==window.bridges[e]&&window.bridges[e](),o=null;if(!n)return window.raise('Fatal error: Bridge "{0}" is not available.'.format(e)),o;var i=n.config,r=0==Object.keys(i).length;if(r?o=new TextTool(n.converter,null,t):"image"==i.type?o=new ImageTool(n.converter,i,t):"binary"==i.type&&(o=new BinaryTool(n.converter,i,t)),!r){var a=i.override;for(var s in a)o.override(s).with(a[s])}return o.start()}function TextTool(e,t,n){return new Tool({converter:e,sides:n.sides,examples:n.examples,chained:n.chained})}function BinaryTool(e,t,n){var o=new Tool({converter:e,sides:n.sides,examples:n.examples,chained:n.chained});function i(e,t){if(this[e].element){"function"==typeof t&&(t=t.call(this));var n=new Blob([this[e].getValue()],{type:"application/octet-stream;charset=utf-8"});saveAs(n,"{0}-{1}.{2}".format(e,this.siteName,t))}}if(t.input&&!0===t.input.binary){var r=o.input.element.querySelector(".binary-textarea");BinaryArea.initializeArea(r),o.input.setValue=function(e){var t=this.input.element.querySelector(".binary-textarea");return BinaryArea.setValue(t,e)}.bind(o),o.input.getValue=function(){var e=this.input.element.querySelector(".binary-textarea");return BinaryArea.getValue(e)}.bind(o),o.input.setBinaryDisplayMode=r.binaryAreaSetMode,o.setExample=function(r){var e,t,n,a=this,o=r.querySelector(".input-sample");if(o.classList.contains("text-sample")){var i=o.querySelector("span"),s=i?i.textContent:"";a.input.setValue(s),a.options.set(a.options.get(r)),a.convert(Trigger.EXAMPLE)}else if(o.classList.contains("file-sample")){var l=o.getAttribute("data-src");a.input.showStatus("loading example..."),e=l,t=function(e){var t=new FileReader;t.onload=function(e){var t=e.target.result;console.log(t);for(var n=new Uint8Array(t),o="",i=0;i<n.length;i++)o+=String.fromCharCode(n[i]);a.input.setValue(o),a.options.set(a.options.get(r)),a.convert(Trigger.EXAMPLE)},t.readAsArrayBuffer(e)},(n=new XMLHttpRequest).onreadystatechange=function(){4==this.readyState&&200==this.status&&t(this.response)},n.open("GET",e,!0),n.responseType="blob",n.send()}zenscroll?zenscroll.intoView(a.sides,400):window.scrollTo(0,a.sides)}.bind(o),BinaryArea.onChange(r,function(){o.convert(Trigger.KEYPRESS)}),o.input.download=i.bind(o,"input",t.input.download||"bin");var a=r.querySelector(".binary-textarea-content");o.input.toClipboard=function(){a.focus(),a.select();try{if(document.execCommand("copy")){o.input.showStatus("copied");var e=o.input.getValue().indexOf(String.fromCharCode(0)),t=-1!==window.navigator.userAgent.indexOf("Windows");-1!==e&&t&&o.input.showWarningBadge("Binary data in clipboard","The binary data you copied contains a NUL character at position {0}. The rest of the data might have been lost.".format(e))}else o.input.showStatus("can't copy")}catch(e){}}}if(t.output&&!0===t.output.binary){r=o.output.element.querySelector(".binary-textarea");BinaryArea.initializeArea(r),o.output.setValue=function(e){var t=this.output.element.querySelector(".binary-textarea");return BinaryArea.setValue(t,e)}.bind(o),o.output.getValue=function(){var e=this.output.element.querySelector(".binary-textarea");return BinaryArea.getValue(e)}.bind(o),o.output.setBinaryDisplayMode=r.binaryAreaSetMode,o.output.download=i.bind(o,"output",t.output.download||"bin");a=r.querySelector(".binary-textarea-content");o.output.toClipboard=function(){a.focus(),a.select();try{if(document.execCommand("copy")){o.output.showStatus("copied");var e=o.output.getValue().indexOf(String.fromCharCode(0)),t=-1!==window.navigator.userAgent.indexOf("Windows");-1!==e&&t&&o.output.showWarningBadge("Binary data in clipboard","The binary data you copied contains a NUL character at position {0}. The rest of the data might have been lost.".format(e))}else o.output.showStatus("can't copy")}catch(e){}}}return o}function ImageTool(e,t,n){var o=new Tool({converter:e,sides:n.sides,examples:n.examples,chained:n.chained});function s(e,t){if(0===e.indexOf("data:")){for(var n=e.slice(5).split(";"),o=window.atob(n[1].split(",")[1]),i=[],r=0;r<o.length;r++)i.push(o.charCodeAt(r));t(new Blob([new Uint8Array(i)],{type:n[0]}))}else{0!==e.indexOf("http:")&&0!==e.indexOf("https:")&&0!==e.indexOf("ftp:")&&0!==e.indexOf("/")&&(e="http://"+e);var a=new XMLHttpRequest;a.onreadystatechange=function(){4==this.readyState&&200==this.status?t(this.response):4==this.readyState&&0==this.status&&s("/get-external-file?url="+e,t)},a.open("GET",e,!0),a.responseType="blob",a.send()}}function l(e,t){t||(t=Trigger.IMPORT);var n=this;n.input.setValue(e,function(){n.input.showStatus("imported"),a.classList.remove("importing"),n.convert(t)})}function i(t,n){var o=this;if(o[t].element)if("function"==typeof n&&(n=n.call(o)),"input"==t){var e=o.input.blob;e?saveAs(e,t+"-"+o.siteName+"."+n):o.input.showStatus("nothing to save")}else{o[t].element.querySelector(".data").toBlob(function(e){saveAs(e,t+"-"+o.siteName+"."+n)},{png:"image/png",jpg:"image/jpeg",bmp:"image/jpeg",gif:"image/gif"}[n])}}function r(e){this[e].showStatus("can't copy images (yet)")}if(t.input){if("base64"==t.input.import&&(o.input.importFromFile=function(e){this.input.showStatus("importing...");var t=e.target.files[0];t?l.call(this,t,Trigger.IMPORT):this.input.showWarningBadge("Can't import","No file was selected.",-1)}.bind(o)),!1===t.parseImage?o.parseImage=!1:o.parseImage=!0,1==t.input.image){o.setExample=function(e){var t=this,n=e.querySelector(".input-sample").getAttribute("data-src");zenscroll?zenscroll.intoView(t.sides,400):window.scrollTo(0,t.sides),t.options.set(t.options.get(e)),t.input.showStatus("loading example..."),s(n,function(e){l.call(t,e,Trigger.EXAMPLE)})}.bind(o),document.addEventListener("paste",function(e,t){this.input.showStatus("importing...");var n=(t.clipboardData||t.originalEvent.clipboardData).items,o="*"==e;for(var i in n){var r=n[i];if("file"===r.kind){var a=r.getAsFile();if(o||-1!==a.type.indexOf(e))l.call(this,a,Trigger.IMPORT);else{var s=a.type?'"'+a.type+'"':"This";this.input.showWarningBadge("Can't import",s+" format is not allowed.",-1)}}}}.bind(o,"image/"));var a=o.input.element.querySelector(".side-box");a.addEventListener("dragover",function(e){e.preventDefault(),this.input.showStatus("drop file to import!");var t=this.input.element.querySelector(".side-box");return t.classList.contains("dragging")||t.classList.add("dragging"),!1}.bind(o),!1),a.addEventListener("dragend",function(e){this.input.element.querySelector(".side-box").classList.remove("dragging");var t=e.dataTransfer;if(t.items)for(var n=0;n<t.items.length;n++)t.items.remove(n);else e.dataTransfer.clearData()}.bind(o),!1),a.addEventListener("dragleave",function(e){e.preventDefault(),this.input.element.querySelector(".side-box").classList.remove("dragging"),this.input.showStatus("")}.bind(o),!1),a.addEventListener("drop",function(e,t){t.preventDefault();var n=this.input.element.querySelector(".side-box");n.classList.remove("dragging"),n.classList.add("importing"),this.input.showStatus("importing...");for(var o=t.dataTransfer.files,i="*"==e,r=0;r<o.length;r++){var a=o[r];if(i||-1!==a.type.indexOf(e))l.call(this,a,Trigger.IMPORT);else{var s=a.type?'"'+a.type+'"':"This";this.input.showWarningBadge("Can't import",s+" format is not allowed.",-1)}}return n.classList.remove("importing"),n.classList.remove("dragging"),!1}.bind(o,"image/"),!1),a.querySelector(".preview").addEventListener("click",function(){o.input.element.querySelector(".side-box").classList.contains("empty")&&o.input.element.querySelector(".widget-load").click()}),o.input.setValue=function t(e,n){var o=this;if(e)if(e instanceof Blob)try{o.input.blob=e;var i=document.createElement("img");i.onload=function(){var e,t=o.input.element.querySelector("canvas.data");o.input.element.querySelector(".side-box").classList.remove("empty"),t.width=i.naturalWidth,t.height=i.naturalHeight,function(e){for(var t=[e.input.element.querySelector("canvas.data"),e.output.element?e.output.element.querySelector("canvas.data"):null,e.input.element.querySelector("canvas.preview"),e.output.element?e.output.element.querySelector("canvas.preview"):null],n=0;n<t.length;n++)t[n]&&(t[n].classList.add("not-empty"),t[n].style.transform="",t[n].removeAttribute("data-scroll-x"),t[n].removeAttribute("data-scroll-y"))}(o),t.getContext("2d").drawImage(i,0,0),URL.revokeObjectURL(i.src),(e=o.input.element.querySelector(".widget-load input[type=file]")).value="",e.type="",e.type="file",n&&n()},i.src=URL.createObjectURL(e)}catch(e){}else"string"==typeof e&&s(e,function(e){t.call(o,e,n)});else n&&n()}.bind(o),o.input.getValue=function(){return this.input.blob}.bind(o),o.restore.input=function(e){var t=e.then;if(e.hasInput){var n=e.queryURL||e.queryInput||e.savedInput;e.showStatus("loading from url..."),o.input.setValue(n,t)}else t()}.bind(o)}t.input.download&&(o.input.download=i.bind(o,"input",t.input.download)),t.input.noClipboard&&(o.input.toClipboard=r.bind(o,"input"))}return t.output&&(t.output.download&&(o.output.download=i.bind(o,"output",t.output.download)),t.output.noClipboard&&(o.output.toClipboard=r.bind(o,"output")),o.output.setValue=function(e){this.output.blob=e}.bind(o),o.output.getValue=function(){return this.output.blob}.bind(o),o.respond=function(e){var t=this;void 0!==e?t.dispatchEvent("response",e):t.output.element.querySelector(".data").toBlob(function(e){t.dispatchEvent("response",e)})}.bind(o)),o}function Tool(v){var y=this;y.sides=v.sides,y.input={getValue:function(){if(!y.input.element)return"";var e=y.input.element.querySelector("textarea.data");return e?e.value:""},setValue:function(e){if(!y.input.element)return"";var t=y.input.element.querySelector("textarea.data");return t?(t.value=e,y.save(),t.value):void 0},showStatus:function(e){var t=y.input.element;return y.showStatus(t,e)},importFromFile:function(e){y.input.showStatus("importing...");var n=e.target.files[0];if(n){var o=new FileReader;o.onload=function(e){var t=o.result;y.input.setValue(t),y.convert(Trigger.IMPORT),y.input.showPositiveBadge("Import successful!",n.name+" ("+sizeToString(n.size)+") imported as plain text.",-1)},o.readAsText(n)}else y.input.showWarningBadge("Can't import","No file was selected.",-1)},download:function(){var e=new Blob([y.input.getValue()],{type:"text/plain;charset=utf-8"});saveAs(e,"input-"+y.siteName+".txt")},toClipboard:function(){return y.toClipboard(y.input)},showWidgetToggle:function(e){y.dispatchEvent("widgetshow",{side:"input",name:e,cause:"function"})},hideWidgetToggle:function(){y.dispatchEvent("widgethide",{side:"input",cause:"function"})},element:null},y.output={getValue:function(){if(!y.output.element)return"";var e=y.output.element.querySelector("textarea.data");return e?e.value:""},setValue:function(e){if(!y.output.element)return"";var t=y.output.element.querySelector("textarea.data");return t?t.value=e:""},showError:function(e){y.output.showNegativeBadge("Can't convert.","An error has occurred."),y.output.showStatus("error"),y.output.setValue("Error: {0}".format(e||"(not specified)"))},download:function(){var e=new Blob([y.output.getValue()],{type:"text/plain;charset=utf-8"});saveAs(e,"output-"+y.siteName+".txt")},toClipboard:function(){return y.toClipboard(y.output)},showStatus:function(e){var t=y.output.element;return y.showStatus(t,e)},showWidgetToggle:function(e){y.dispatchEvent("widgetshow",{side:"output",name:e,cause:"function"})},hideWidgetToggle:function(){y.dispatchEvent("widgethide",{side:"output",cause:"function"})},element:null},y.save=function(){if(y.isPrimary){if("undefined"==typeof Storage)return y.warn("error:save","local storage not supported"),!1;var e,t=!!y.input.element&&y.input.element.querySelector(".data"),n=y.options.element,o=window.localStorage||null;if(o&&o.setItem("autosave_origin",window.location.pathname),t&&null!==t.getAttribute("data-autosave"))o.autosave_input!==(e=y.input.getValue())&&(o&&o.setItem("autosave_input",e),y.input.showStatus("saved"));if(n&&null!==n.getAttribute("data-autosave"))isEquivalent(o.autosave_options||{},e=JSON.stringify(y.options.get()))||o&&o.setItem("autosave_options",e)}},y.restore={input:function(e){var n=e.then;if(e.hasInput){var t=function(e){var t=y.input.setValue;2==t.length?t(e,n.bind(null,!0)):1==t.length&&(t(e),n(!0))},o=function(e,t){0!==e.indexOf("http:")&&0!==e.indexOf("https:")&&0!==e.indexOf("ftp:")&&0!==e.indexOf("/")&&(e="http://"+e);var n=new XMLHttpRequest;n.onreadystatechange=function(){4==this.readyState&&200==this.status?t(this.responseText):4==this.readyState&&0==this.status&&o("/get-external-file?url="+e,t)},n.open("GET",e,!0),n.responseType="text",n.send()};e.queryURL?(e.showStatus("loading from {0}...".format(function(e){var t=document.createElement("a");t.href=e;var n=t.hostname.split("."),o=n[n.length-1],i=n[n.length-2];return i&&o?i+"."+o:"url"}(e.queryURL))),o(e.queryURL,t)):(e.showStatus("loading from input..."),t(e.queryInput||e.savedInput))}else n()},options:function(e){var t=e.then;if(e.hasOptions){e.savedOptions&&y.options.set(e.savedOptions);var n=y.options.get(),o={};for(var i in e.fullQuery){var r=void 0!==e.fullQuery[i],a=void 0!==n[i];r&&a&&(o[i]=e.fullQuery[i])}var s=0<Object.keys(o).length;s&&y.options.set(o),t(s)}else t(!1)},all:function(){if(y.isPrimary){var e=window.localStorage||{};e.autosave_origin&&window.location.pathname!==e.autosave_origin&&(e.autosave_input="",e.autosave_options="{}");var t=getURLQuery(),n=e.autosave_input||"",o=JSON.parse(e.autosave_options||"{}"),i=t.input,r=t["input-url"];y.restore.input({savedInput:n,queryInput:i,showStatus:y.input.showStatus,hasInput:!!y.input.element,queryURL:r,then:function(){y.restore.options({savedOptions:o,hasOptions:!!y.options.element,fullQuery:t,then:function(e){y.convert(Trigger.RESTORE),null===i&&y.input.showWarningBadge("Can't load input from query","The ?input parameter is malformed."),null===r&&y.input.showWarningBadge("Can't load input from URL","The ?input-url parameter is malformed.")}})}})}}},y.swap=function(e){if(y.input.element&&y.output.element){var t=y.input.getValue()||"",n=y.output.getValue()||"",o=y.input.element.querySelector("label"),i=y.output.element.querySelector("label");if(!o.style.left){var r=Math.abs(i.getBoundingClientRect().left-o.getBoundingClientRect().left);if(o.style.left=r+"px",i.style.left=-1*r+"px",y.input.setValue(n),y.output.setValue(t),"undefined"!=typeof Storage){var a=window.localStorage;a.setItem("autosave_origin","/"+e),a.setItem("autosave_input",n)}setTimeout(function(){window.location.assign("/"+e)},100)}}},y.trigger=null,y.resetErrorsOnConvert=!0,y.respond=function(e){void 0===e&&(e=y.output.getValue()),y.dispatchEvent("response",e)},y.events={response:[],optionchange:[],widgetshow:[],widgethide:[]},y.dispatchEvent=function(e,t){if(-1===Object.keys(y.events).indexOf(e))throw'Event "'+e+'" is not supported';for(var n=y.events[e],o=0;o<n.length;o++){var i=n[o].handler.call(y,t);if(n[o].once&&y.events[e].splice(o,1),!1===i)break}},y.removeEventListener=function(e,t){if(-1===Object.keys(y.events).indexOf(e))throw'Event "'+e+'" is not supported';if(void 0===t)throw"Listener note is not specified";for(var n=y.events[e],o=0;o<n.length;o++)n[o].note==t&&y.events[e].splice(o,1)},y.addEventListener=function(e){"object"!=typeof e&&(e={});var t=e.event||"undefined",n=e.handler||!1;if(!n)throw"Event handler is not specified";if(-1===Object.keys(y.events).indexOf(t))throw'Event "'+t+'" is not supported';y.events[t].push({handler:n,note:e.note||void 0,once:e.once||!1})},y.isPrimary=!v.chained,y.chainParent=null,y.chainChild=null,y.getCompatibility=function(){var e=y.sides;return{accepts:e.getAttribute("data-accepts")||!1,returns:e.getAttribute("data-returns")||!1}},y.attachChain=function(n){((y.chainChild=n).chainParent=y).addEventListener({event:"response",note:"chain",handler:function(e){var t=n.input.setValue;y.log({type:"chain propagate",from:y,to:n,data:e}),2==t.length?t(e,function(){n.convert(Trigger.CHAIN)}):1==t.length&&(t(e),n.convert(Trigger.CHAIN))}});var e=y.output.getValue();if(e){y.log({type:"chain connect",from:y,to:n,data:e});var t=n.input.setValue;2==t.length?t(e,function(){n.convert(Trigger.CHAIN)}):1==t.length&&(t(e),n.convert(Trigger.CHAIN))}},y.removeChain=function(){y.chainChild.chainParent=null,y.chainChild=null,y.removeEventListener("response","chain")},y.convert=function(e){var t=!!y.input.element,n=!!y.output.element;if(y.trigger=null,e&&(y.trigger=e),y.log({type:"conversion",trigger:e}),t&&n){var o=y.input.getValue();try{void 0!==(i=y.converter(o))&&y.dispatchEvent("response",i)}catch(e){window.raise("<b>Conversion error:</b> "+e.toString()),console.error(e),o?(y.warn("error:converting",e.toString()),y.output.showError(e)):y.output.setValue("")}}else if(t&&!n){y.resetErrorsOnConvert&&y.input.hideBadge();try{o=y.input.getValue();y.converter(o)}catch(e){window.raise("<b>Conversion error:</b> "+e.toString()),console.error(e),o?(y.warn("error:converting",e.toString()),y.input.showNegativeBadge("Error has occured",e,-1)):y.output.setValue("")}}else if(!t&&n)try{var i;void 0!==(i=y.converter())&&y.dispatchEvent("response",i)}catch(e){window.raise("<b>Conversion error:</b> "+e.toString()),console.error(e),y.warn("error:converting",e.toString()),y.output.showError(e)}y.save()},y.converter=function(){},y.options={default:null,get:function(e){var t=y.sides.getAttribute("data-override-options");if(e||(e=y.options.element),!e)return t?JSON.parse(t):{};null!==e.getAttribute("data-resets-all-options")&&y.options.reset();for(var n=e.querySelectorAll(".input-option"),o={},i=0;i<n.length;i++){var r=n[i],a=r.getAttribute("data-index"),s=null,l=r.tagName.toLowerCase();"checkbox"==r.type||"radio"==r.type?s=r.checked:"text"!=r.type&&"textarea"!=l&&"select"!=l||(s=r.value),o[a]=s}if(t){var u=JSON.parse(t);for(var c in u)o[c]=u[c]}return o},set:function(e){var t=y.options.element;if(t)for(var n=t.querySelectorAll(".input-option"),o=0;o<n.length;o++){var i=n[o],r=i.getAttribute("data-index");if(void 0!==e[r]){var a=e[r],s=i.tagName.toLowerCase();"checkbox"==i.type||"radio"==i.type?i.checked=a:"text"!=i.type&&"textarea"!=s&&"select"!=s||(i.value=a),"textarea"==i.type&&autosize.update(i)}}return y.options.get()},reset:function(){y.options.set(y.options.default)},describe:function(e,t){var n=y.options.element;if(n){var o=n.querySelector('.option-detail-key[data-detail-key="'+e+'"]');o&&(o.innerText=t)}return y.options.get()},element:null},y.accidents=[],y.warn=function(e,t){var n={event:e,data:t};y.accidents.push(n),window.raise("<b>Tool warning:</b> ("+e.toString()+") "+t.toString(),"warning")},y.log=function(e){window.log(y,e)},y.init=function(){var o=y.sides,e=v.examples;y.input.element=o.querySelector(".side.input"),y.output.element=o.querySelector(".side.output"),y.options.element=o.querySelector(".converter-options");var t=y.options.element?y.options.element.querySelectorAll(".option-row .option-details"):null;if(t)for(var n=0;n<t.length;n++){var i=t[n];i.innerHTML=i.innerHTML.replace(/&lt;([a-z0-9\-]+)&gt;/gi,function(e,t){var n=document.createElement("span");return n.className="option-detail-key",n.setAttribute("data-detail-key",t),n.innerText="<"+t+">",n.outerHTML})}var r=o.querySelector(".tool-toggle-layout");r&&r.addEventListener("click",function(){o.classList.toggle("expanded"),setTimeout(function(){y.convert(Trigger.RESIZE)},100)});var a=o.querySelector(".sides-primary-button button");a&&a.addEventListener("click",function(){y.convert(Trigger.ACTION)});var s=o.querySelector(".tool-swap");s&&s.addEventListener("click",function(e){var t=s.getAttribute("data-swap-to");y.swap(t)});var g=o.querySelector(".tool-create-link"),h=o.querySelector(".sides-wrapper"),l=o.querySelector(".tweet-link-button");if(l&&l.addEventListener("click",function(){var e=this.getAttribute("data-tweet-url");window.open(e)}),g){var f=g.querySelector(".tool-link"),m=function(e){e&&f.contains(e.target)||(!e||e.stopPropagation(),g.classList.remove("active"),h.classList.remove("muted"),document.removeEventListener("click",m))};g.addEventListener("click",function(e){if(!f.contains(e.target))if(g.classList.contains("active"))m();else{var t=f.querySelector("input"),n=window.location.origin+window.location.pathname+"?",o=[],i=y.options.get(),r=JSON.parse(y.sides.getAttribute("data-override-options")||"{}"),a=getChainData(y);if(0<a.length&&o.push("chain="+encodeURIComponent(a.join(","))),y.input.element){var s="string"==typeof y.input.getValue(),l=getURLQuery("input"),u=getURLQuery("input-url");u?o.push("input-url="+encodeURIComponent(u)):l?o.push("input="+encodeURIComponent(l)):s&&o.push("input="+encodeURIComponent(y.input.getValue()))}var c=Object.keys(i);if(c.length)for(var d=0;d<c.length;d++){var p=c[d];if(void 0===r[p]){var v=i[p];o.push(encodeURIComponent(p)+"="+encodeURIComponent(v))}}t.value=n+o.join("&"),e.stopPropagation(),g.classList.add("active"),h.classList.add("muted"),document.addEventListener("click",m),setTimeout(function(){t.select(),t.focus(),t.select()},201)}})}y.input.element&&(y.input.element.addEventListener("keyup",function(){y.convert(Trigger.KEYPRESS)}),o.querySelector(".widget-load").addEventListener("click",function(){o.querySelector(".widget-load input").click()}),o.querySelector(".widget-load input").addEventListener("change",function(e){y.input.importFromFile(e)},!1),o.querySelector(".input .widget-save-as").addEventListener("click",function(){y.input.showStatus("saving..."),y.input.download()}),o.querySelector(".input .widget-copy").addEventListener("click",function(){y.input.toClipboard()}));if(y.output.element&&(y.addEventListener({event:"widgetshow",handler:function(e){if("toggle-chain"==e.name){var t=o.querySelector(".output");populateChainCombinator(y,t)}}}),y.addEventListener({event:"widgetshow",handler:function(e){if("toggle-remove-chain"==e.name){var t=getChainData(y).length;1==t?t+=" tool":1<t&&(t+=" tools"),o.querySelector(".output .toggle-remove-chain .remove-how-many").textContent=t}}}),y.addEventListener({event:"widgethide",handler:function(e){var t=o.querySelector(".output"),n=t.classList.contains("combinator-active");"output"==e.side&&n&&t.classList.remove("combinator-active")}})),y.globalHandlers.convertOnResize=y.globalHandlers.convertOnResize.bind(y),window.addEventListener("resize",y.globalHandlers.convertOnResize),e){var u=e.querySelectorAll(".card");if(u)for(n=0;n<u.length;n++)!function(t){t.addEventListener("click",function(e){y.setExample.call(y,t)})}(u[n])}y.addEventListener({event:"optionchange",handler:y.convert.bind(y,Trigger.OPTIONS)});var c=o.querySelectorAll(".converter-options .input-option");if(c)for(n=0;n<c.length;n++){var d=c[n];d.addEventListener("change",y.dispatchEvent.bind(y,"optionchange")),d.addEventListener("keyup",y.dispatchEvent.bind(y,"optionchange"))}y.addEventListener({event:"response",handler:function(e){y.log({type:"response self",data:e}),this.output.setValue(e)}}),y.addEventListener({event:"widgetshow",handler:function(e){showWidgetToggle(y,e.side,e.name)}}),y.addEventListener({event:"widgethide",handler:function(e){hideWidgetToggle(y,e.side)}}),(o.tool=y).converter=v.converter;var p=(y.sides=o).querySelector(".tool-favorite");p&&(p.addEventListener("click",y.favorite.bind(y)),y.favorite()),y.options.default=y.options.get()},y.override=function(e){e=e.split(".");for(var t=y,n=null,o=0;o<e.length;o++){if(n=e[o],void 0===t[n])throw"tool."+e.splice(0,o).join(".")+" does not contain "+n;o!=e.length-1&&(t=t[n])}return{with:function(e){t[n]=e.bind(y)}}},y.destroy=function(){for(var e in y.output.element=null,y.output.tool=null,y.input.element=null,y.input.tool=null,y.options.element=null,y.converter=null,y.sides.tool=null,y.sides.innerHTML=y.sides.innerHTML,y.sides.parentElement.removeChild(y.sides),y.sides=null,y.events)y.events[e]=[];window.removeEventListener("resize",y.globalHandlers.convertOnResize),y=null},((y.input.tool=y).output.tool=y).init(),y.start=function(){return y.restore.all(),y}}window.bridges={},window.primaryTool=null,window.addEventListener("load",function(){makeAutosizeTextareas(),makeColorpickers(),makeWrappingExamples(),makePrimaryTool(),chainPrimaryTool()});var Trigger=Object.freeze({OPTIONS:1,ACTION:2,KEYPRESS:3,RESIZE:4,RESTORE:5,EXAMPLE:6,IMPORT:7,CHAIN:8});function makeWrappingExamples(){window.addEventListener("resize",updateExamples),updateExamples()}function chainSearch(e){for(var t=e.querySelector(".side.output"),n=t.querySelector(".tool-combinator .combinator-tools"),o=n.querySelectorAll(".combinator-tool"),i=function(e){return Site.removeStopWords(e.toLowerCase())},r=i(t.querySelector(".side-widgets .toggle-chain .chain-search").value),a=0;a<o.length;a++){var s=o[a],l=i(s.querySelector(".combinator-title").textContent),u=i(s.querySelector(".combinator-description").textContent);s.classList.remove("hidden"),-1===l.indexOf(r)&&-1===u.indexOf(r)&&(s.classList.add("hidden"),n.appendChild(s))}}function makeColorpickers(){Site.applyToAllElements(".input-option.color.active.not-initialized",function(e){e.classList.remove("not-initialized"),Colorpicker.create(e)})}function makeAutosizeTextareas(){Site.applyToAllElements("textarea.autosize.not-initialized",function(e){e.classList.remove("not-initialized"),autosize(e)})}function makeScrollablePreviews(){var e=document.querySelectorAll(".preview-scrollable");if(e)for(var t=0;t<e.length;t++)scrollablePreview(e[t])}function populateChainCombinator(c,d){var p=d.querySelector(".side-widgets-toggle .toggle-chain .widget-chain-search"),v=p.querySelector(".chain-search"),g=d.querySelector(".tool-combinator .combinator-list"),e=c.getCompatibility().returns||"nothing";p.classList.remove("state-wait"),p.classList.remove("state-search"),p.classList.remove("state-error"),p.classList.add("state-wait"),v.disabled=!0,v.value="",g.scrollTop=0,v.placeholder="Connecting to server...";var t="all-tools.json?accepts={0}".format(e);Site.GET(t,function(e){var t=e.responseText;if(4==e.readyState&&200==e.status)try{var n=JSON.parse(t);if(n.error||!n.json)p.classList.remove("state-wait"),p.classList.add("state-error"),v.placeholder="Tools unavailable.";else{v.placeholder="Loading all tools...";for(var o=g.querySelector(".combinator-tools");o.firstChild;)o.removeChild(o.firstChild);for(var i in n.json)for(var r=0;r<n.json[i].length;r++){var a=n.json[i][r],s=document.createElement("div");s.className="combinator-tool",s.setAttribute("data-url",a.url);var l=document.createElement("span");l.className="combinator-title",l.textContent=a.title;var u=document.createElement("span");u.className="combinator-description",u.textContent=a.desc,s.appendChild(l),s.appendChild(u),s.addEventListener("click",function(){chainToolWith(c,this.getAttribute("data-url")),c.output.hideWidgetToggle()}),o.appendChild(s)}setTimeout(function(){p.classList.remove("state-wait"),p.classList.add("state-search"),v.disabled=!1,v.placeholder="Search all tools...",v.focus(),d.classList.remove("combinator-active"),d.classList.add("combinator-active")},250)}}catch(e){p.classList.remove("state-wait"),p.classList.add("state-error"),v.placeholder="Can't load."}else 4==e.readyState&&(p.classList.remove("state-wait"),p.classList.add("state-error"),v.placeholder="Unexpected response.")})}function makeToggleableWidgets(o,i){for(var e=side_widgets.querySelectorAll(".widget"),t=0;t<e.length;t++)!function(n){n.addEventListener("click",function(){var e=n.getAttribute("data-toggle"),t=null!==n.getAttribute("data-hides-toggle");e&&o.dispatchEvent("widgetshow",{side:i,cause:"click",name:e}),t&&o.dispatchEvent("widgethide",{side:i,cause:"click"})})}(e[t]);window.addEventListener("keyup",function(e){e.key.toLowerCase()})}function hideWidgetToggle(e,t){var n=e[t].element;if(n){var o=n.querySelector(".side-widgets"),i=o.querySelector(".side-widgets-wrapper"),r=o.querySelector(".side-widgets-toggle");i.style.transform="rotateX(0deg) translateY(0px) translateZ(0px)",r.style.transform="rotateX(90deg) translateY(-50%) translateZ({0}px)".format(o.offsetHeight/2),o.classList.remove("toggled")}}function showWidgetToggle(e,t,n){var o=e[t].element;if(o){var i=o.querySelector(".side-widgets"),r=i.querySelector(".side-widgets-wrapper"),a=i.querySelector(".side-widgets-toggle");if(hideWidgetToggle(e,t),n){var s=a.querySelector("."+n);if(s){for(var l=i.querySelectorAll(".side-widgets-toggle .toggle-wrapper .widget-toggle"),u=0;u<l.length;u++)l[u].classList.remove("toggle-active");s.classList.add("toggle-active"),a.style.transform="rotateX(0deg) translateY(0px) translateZ(0px)",r.style.transform="rotateX(-90deg) translateY(50%) translateZ({0}px)".format(i.offsetHeight/2),i.classList.remove("toggled"),i.classList.add("toggled")}else window.raise("Widget tried to toggle section .{0}, but it does not exists.".format(n))}}}function updateExamples(){for(var e=document.querySelectorAll(".examples .wrapper"),t=0;t<e.length;t++){var n=e[t],o=n.querySelector(".sample");if(!o.querySelector(".file-sample")){o.classList.remove("big");n.getBoundingClientRect().width-5<=o.scrollWidth&&o.classList.add("big")}}}function buildURLQuery(e){var t=[];for(var n in e){var o=e[n];t.push(encodeURIComponent(n)+(o?"="+encodeURIComponent(o):""))}return"?"+t.join("&")}function getURLQuery(e){for(var t=window.location.search.substring(1).split("&"),n={},o=0;o<t.length;o++){var i=t[o].split("=");try{var r=decodeURIComponent(i[0])}catch(e){continue}try{var a=decodeURIComponent(i[1]||"")}catch(e){a=null}"true"!=a&&"yes"!=a&&"false"!=a&&"no"!=a||(a="true"==a||"yes"==a),r&&(n[r]=a)}return e?n[e]:n}function isEquivalent(e,t){if("object"!=typeof e||"object"!=typeof t)return!1;var n=Object.getOwnPropertyNames(e),o=Object.getOwnPropertyNames(t);if(n.length!=o.length)return!1;for(var i=0;i<n.length;i++){var r=n[i];if(e[r]!==t[r])return!1}return!0}function sizeToString(e,t){if(0==e)return"empty";var n=t||2,o=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,o)).toFixed(n))+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][o]}Tool.prototype.globalHandlers={convertOnResize:function(){this.convert(Trigger.RESIZE)}},Tool.prototype.setExample=function(e){var t=this,n=e.querySelector(".text-sample.input-sample span"),o=n?n.textContent:"";t.input.setValue(o),t.options.set(t.options.get(e)),t.convert(Trigger.EXAMPLE),zenscroll?zenscroll.intoView(t.sides,400):window.scrollTo(0,t.sides)},Tool.prototype.favorite=function(e){if("undefined"!=typeof Storage){var t=window.localStorage||null,n=JSON.parse(t&&t.favorite_tools||"[]"),o="/"+window.location.pathname.split("/")[1];if(e){var i=n.indexOf(o);-1!==i?n.splice(i,1):n.push(o)}t&&t.setItem("favorite_tools",JSON.stringify(n));var r=-1!==n.indexOf(o),a=this.sides.querySelector(".tool-favorite");a.classList.remove("active"),r&&a.classList.add("active"),Site.sortAllTools()}},Tool.prototype.showStatus=function(e,t){if(e){var n=e.querySelector("label .status"),o=Math.random();n.textContent=t,n.className="status active",n.setAttribute("animation-id",o),setTimeout(function(){o==n.getAttribute("animation-id")&&(n.classList.remove("active"),setTimeout(function(){n.textContent=""},200))},1e3)}},Tool.prototype.toClipboard=function(e){e.element.querySelector(".data").select();try{document.execCommand("copy")?e.showStatus("copied"):e.showStatus("can't copy")}catch(e){}};