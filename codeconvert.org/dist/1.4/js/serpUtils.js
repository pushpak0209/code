function checkRankOnenter(e){13==e.which&&$("#check").click()}function checkRank(){if(null==$("#url").val()||0==$("#url").val().length)return openErrorDialog("Please Enter Url"),!1;if(null==$("#keywords").val()||0==$("#keywords").val().length)return openErrorDialog("Please Enter keywords"),!1;$("#results").removeClass("hide"),$("#hResult").addClass("hide"),$("#hResultNeighbours").addClass("hide"),$("#hResult1").addClass("hide"),$("#userHistoryDiv").addClass("hide");var p=$("#url").val();p=(p=(p=p.replace("http://"," ")).replace("https://"," ")).trim();var e=$("#country").val();$("#results").html('<img id="serpLoding">Please wait while we search...it may take up to 60 seconds to complete your search.'),$.post("SerpChecker",{d:p,k:$("#keywords").val(),c:e,countryName:$("#country option:selected").text(),dataType:"json"},function(e){if("googleFailed"==e)return $("#results").html("<h3 style='color:red;'>Unable to reach google at this time, please try again later.</h3>"),!1;if("domainFailed"==e){var t="<h3 style='color:red;'>Domain not found : '"+p+"' Please verify the name.</h3>";return $("#results").html(t),!1}var r=JSON.parse(e),o=r.result,a=[],s=[],i=0,l=0;if(parseInt(o.spot)==o.spot&&(i=parseInt(o.spot)),('[""]'!=o.previous||"--"!=o.previous||"from cache"==o.total_search&&1!=o.spot)&&(0!=i&&(i-=1),0!=i)){o.previous=o.previous.replace(/\\/g,""),null==o.previous&&(o.previous=getHost(o.previous));var n="<a href="+o.previous+" target='_blank'>"+o.previous+"</a>";s[l]=[n,$("#keywords").val(),o.total_search,i,o.page],l++}null!=o.full_domain&&(o.full_domain=o.full_domain.replace(/\\/g,"")),null==o.full_domain&&(o.full_domain=getHost(o.full_domain));var u="<a href="+o.full_domain+" target='_blank'>"+o.full_domain+"</a>";if(a[0]=[u,$("#keywords").val(),o.total_search,o.spot,o.page],'[""]'!=o.next||"--"!=o.next||"from cache"==o.total_search){0!=i&&"--"!=o.previous?i+=2:i=parseInt(o.spot)+1,o.next=o.next.replace(/\\/g,""),null==o.next&&(o.next=getHost(o.next));var d="<a href="+o.next+" target='_blank'>"+o.next+"</a>";s[l]=[d,$("#keywords").val(),o.total_search,i,o.page]}$("#hResult").removeClass("hide"),null!=a&&0!=a.length&&$("#keyWordResult").dataTable({bRetrieve:!1,bDestroy:!0,bPaginate:!1,bInfo:!1,bFilter:!1,bJQueryUI:!0,aaData:a,oLanguage:{sEmptyTable:"No Result Found"},aoColumns:[{sTitle:"Domain",bVisible:!0},{sTitle:"Keywords",bVisible:!0},{sTitle:"Total Search",bVisible:!0},{sTitle:"Spot",bVisible:!0},{sTitle:"Page",bVisible:!0}]}),null!=s&&0!=s.length||(s=[]),$("#hResultNeighbours").removeClass("hide"),$("#keyWordResultNeighbours").dataTable({bRetrieve:!1,bDestroy:!0,bPaginate:!1,bInfo:!1,bFilter:!1,bJQueryUI:!0,aaData:s,oLanguage:{sEmptyTable:"No Result Found"},aoColumns:[{sTitle:"Domain",bVisible:!0},{sTitle:"Keywords",bVisible:!0},{sTitle:"Total Search",bVisible:!0},{sTitle:"Spot",bVisible:!0},{sTitle:"Page",bVisible:!0}]}),$.fn.dataTableExt.sErrMode="mute",$("#results").hide(),$(".fg-toolbar").hide();var h=[];$.each($.parseJSON(r.history),function(e,t){var r=new Date(t.date),o="Rank is "+parseInt(t.spot);0==parseInt(t.spot)&&(o=" Rank was greater then 100",t.spot=100),h[e]=[new Date(r.getFullYear(),r.getMonth(),r.getDate()),parseInt(t.spot),o]}),drawKeywordRankGraph(h),null!=r.user_history&&null!=r.user_history?($userHistory=[],$.each($.parseJSON(r.user_history),function(e,t){t.pre_compititor=t.pre_compititor.replace(/\\/g,""),t.next_compititor=t.next_compititor.replace(/\\/g,"");var r="<a href="+t.pre_compititor+">"+t.pre_compititor+"</a>",o="<a href="+t.next_compititor+">"+t.next_compititor+"</a>";0==t.spot&&(t.spot=">100"),$userHistory[e]=[e+1,t.keywords,t.spot,t.page,r,o,t.total_search]}),showUserKeywordHistoryTable($userHistory)):$("#userHistoryDiv").addClass("hide")}).fail(function(){$("#results").html('<h3 style="color:red;">The server returned an error, please try again later.</h3>')})}function drawKeywordRankGraph(e){$("#hResult1").removeClass("hide");var t=new google.visualization.DataTable;t.addColumn("date","Date"),t.addColumn("number","Rank"),t.addColumn({type:"string",role:"tooltip"}),t.addRows(e);new google.visualization.LineChart(document.getElementById("historyResult")).draw(t,{vAxis:{direction:-1},format:"#",title:"Rank History","hAxis.showTextEvery":5,"hAxis.viewWindowMode":"maximized",pointSize:5,"hAxis.maxValue":10})}function saveMonitorKeyword(){if(null==getProvider())return openErrorDialog("Please Login for Monitor Keyword"),!1;var e=$("#url").val();e=(e=(e=e.replace("http://"," ")).replace("https://"," ")).trim(),$.ajax({url:"/service/saveMonitorKeyword",type:"post",data:{keyword:$("#keywords").val(),domain:e,country:$("#country option:selected").text(),country_code:$("#country").val()},success:function(e){"success"==e?openErrorDialog("Your keyword registered for monitering"):"exist"==e?openErrorDialog("Your keyword already registered for monitering"):openErrorDialog("Error at :  keyword registered for monitering")}})}function showUserKeywordHistoryTable(e){$("#userHistoryDiv").removeClass("hide"),$("#userHistoryTable").dataTable({bRetrieve:!1,bDestroy:!0,bPaginate:!0,bJQueryUI:!0,aaSorting:[[0,"asc"]],aaData:e,oLanguage:{sEmptyTable:"No Data Found"},aoColumns:[{sTitle:"No.",bVisible:!0,sWidth:"3%"},{sTitle:"Keywords",bVisible:!0},{sTitle:"Spot",bVisible:!0},{sTitle:"Page",bVisible:!0},{sTitle:"Previous Compititer",bVisible:!0},{sTitle:"Next Compititor",bVisible:!0},{sTitle:"Total Search",bVisible:!0}]}),$(".fg-toolbar").hide(),$.fn.dataTableExt.sErrMode="mute"}function getHost(e){var t=document.createElement("a");return t.href=e,"localhost"==t.hostname&&(hostname="--"),t.hostname}