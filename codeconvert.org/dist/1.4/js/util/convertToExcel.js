function convertToExcel(e){var o=editorAce.getValue(),l=$("#fileExtention").val(),n=null,s=null;if(null!=o&&0!=o.length){if("json"==e.toLowerCase())n=jsonTocsvbyjson(o,!0,"excel");else if("xml"==e.toLowerCase()){if("undefined"==typeof X2JS)return void $.loadScript("https://cdnjs.cloudflare.com/ajax/libs/x2js/1.2.0/xml2json.min.js",function(){convertToExcel(e)});var t=new X2JS;try{o=$.parseXML(o)}catch(e){openErrorDialog("Invalid XML")}s=t.xml2json(o),n=jsonTocsvbyjson(s,!0,"excel")}else if("csv"==e.toLowerCase()){for(var r=(n=o).split(/\r\n|\n/),i=r[0].split(","),a=[],c=1;c<r.length;c++)if((o=r[c].split(",")).length==i.length){for(var f={},v=0;v<i.length;v++)f[i[v]]=o[v];[].push(f),a.push(f)}n=csvToExcel(a,i,!0,"excel")}else"yaml"==e.toLowerCase()&&(s=yamlToJson(!0),n=jsonTocsvbyjson(s,!0,"excel"));if(null!=n&&0!=n.trim().length){var p="application/vnd.ms-excel";"xlsx"==l&&(p="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");var x=new Blob([n],{type:p});fileDownloadCB(x,"codeconvert."+l)}else openErrorDialog("Sorry Try Again,Some error in convterting to excel")}}
